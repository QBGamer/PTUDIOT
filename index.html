
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BẢNG ĐIỀU KHIỂN</title>
    
    <!-- Bootstrap -->
    <link rel="stylesheet" href="./css/bootstrap.css">
    <script src="./js/bootstrap.bundle.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.2/font/bootstrap-icons.min.css">
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.6.1.min.js" type="text/javascript"></script>
    <!-- MQTT -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.min.js" type="text/javascript"></script>
    <!-- Normal -->
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
<!-- web speak recor api -->
<div class="container-fluid p-2">
    <h1 class="text-center py-3">BẢNG ĐIỀU KHIỂN</h1>
    <div class="px-2">
        <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3">
            <div class="col mt-2">
                <div class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-cloud-sun-fill"></i></th>
                            <th>Thời tiết:</th>
                            <th id="infoweather">???</th>
                        </tr>
                        <tr>
                            <th id="wtemp">???</th>
                            <th id="whumi">???</th>
                            <th id="wwind">???</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="col mt-2">
                <div data-bs-toggle="modal" data-bs-target="#Temperature" class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-thermometer-half"></i></th>
                            <th>Nhiệt độ:</th>
                        </tr>
                        <tr>
                            <th id="temp">???</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="col mt-2">
                <div data-bs-toggle="modal" data-bs-target="#Humidity" class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-droplet-fill"></i></th>
                            <th>Độ ẩm:</th>
                        </tr>
                        <tr>
                            <th id="humi">???</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="col mt-2">
                <div data-bs-toggle="modal" data-bs-target="#Light" class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-brightness-alt-low-fill"></i></th>
                            <th>Mức sáng:</th>
                        </tr>
                        <tr>
                            <th id="light">???</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="col mt-2">
                <div class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-house-door-fill"></i></th>
                            <th>Tầng hầm:</th>
                        </tr>
                        <tr>
                            <th id="storge">???</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="col mt-2">
                <div data-bs-toggle="modal" data-bs-target="#Water" class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-water"></i></th>
                            <th>Bồn nước:</th>
                        </tr>
                        <tr>
                            <th id="water">???</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="col mt-2">
                <div class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-fire"></i></th>
                            <th>Khí gas:</th>
                        </tr>
                        <tr>
                            <th id="gas">???</th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="col mt-2">
                <div data-bs-toggle="modal" data-bs-target="#Warning" class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-exclamation-triangle-fill"></i></th>
                            <th>Báo động:</th>
                        </tr>
                        <tr>
                            <th id="sec">???</th>
                        </tr>
                    </table>
                </div>                
            </div>
            <div class="col mt-2">
                <div data-bs-toggle="modal" data-bs-target="#Other" class="card border-3 border-bottom-0 border-start-0 border-end-0 border-primary py-3">
                    <table>
                        <tr>
                            <th rowspan="2" class="fs-3 icons text-center"><i class="bi-gear-fill"></i></th>
                            <th>Thiết bị khác</th>
                        </tr>
                        <!-- <tr>
                            <th>???</th>
                        </tr> -->
                    </table>
                </div>                
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="Other" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Thiết bị khác</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="form-check form-switch fs-3">
                <input id="btnled" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnled">Đèn</label>
            </div>
            <div class="form-check form-switch fs-3">
                <input id="btndoor" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btndoor">Cửa</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tắt</button>
        </div>
      </div>
    </div>
</div>

<div class="modal fade" id="Temperature" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Nhiệt độ</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="form-check form-switch fs-3">
                <input id="btnair" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnair">Máy lạnh</label>
            </div>
            <div class="form-check form-switch fs-3">
                <input id="btnairat" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnairat">Chế độ tự động</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tắt</button>
        </div>
      </div>
    </div>
</div>

<div class="modal fade" id="Humidity" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Độ ẩm</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="form-check form-switch fs-3">
                <input id="btnhumi" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnhumi">Máy tạo độ ẩm</label>
            </div>
            <div class="form-check form-switch fs-3">
                <input id="btnhumiat" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnhumiat">Chế độ tự động</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tắt</button>
        </div>
      </div>
    </div>
</div>

<div class="modal fade" id="Light" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Mức sáng</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="form-check form-switch fs-3">
                <input id="btnlight" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnlight">Đèn ngoài</label>
            </div>
            <div class="form-check form-switch fs-3">
                <input id="btnlightat" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnlightat">Chế độ tự động</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tắt</button>
        </div>
      </div>
    </div>
</div>

<div class="modal fade" id="Water" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Bồn nước</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <div class="form-check form-switch fs-3">
                <input id="btnwater" class="form-check-input" type="checkbox" role="switch">
                <label class="form-check-label" for="btnwater">Vòi nước</label>
            </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tắt</button>
        </div>
      </div>
    </div>
</div>

<div class="modal fade" id="Warning" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="staticBackdropLabel">Báo động</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <button id="btnwarn" class="btn btn-danger" type="button">Tắt báo động</button>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tắt</button>
        </div>
      </div>
    </div>
</div>
<div class="mic"><button class="micro btn btn-primary fs-1 fw-bold"><i class="bi-mic-fill"></i></button></div>
<div class="modal fade" id="logs" tabindex="-1" aria-labelledby="logsLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable modal-fullscreen">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="logsLabel">Lịch sử thiết bị</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <table id="dataTable">
            <thead>
                <tr>
                <th>Thời gian</th>
                <th>Nhiệt độ</th>
                <th>Độ ẩm</th>
                <th>Độ sáng</th>
                <th>Chuyển động</th>
                <th>Khí gas</th>
                <th>Báo động</th>
                <th>Mực nước</th>
                <th>Máy lạnh</th>
                <th>Máy lạnh AT</th>
                <th>Máy độ ẩm</th>
                <th>Máy độ ẩm AT</th>
                <th>Đèn ngoài</th>
                <th>Đèn ngoài AT</th>
                <th>Cửa</th>
                <th>Đèn</th>
                <th>Vòi nước</th>
                </tr>
            </thead>
            <tbody id="logdata"></tbody>
            </table>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="voicecmd" tabindex="-1" aria-labelledby="logsLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="logsLabel">Danh sách khẩu lệnh</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
            <p>Nhà thông minh bật/tắt máy lạnh</p>
            <p>Nhà thông minh máy lạnh tự động bật/tắt</p>
            <p>Nhà thông minh bật/tắt độ ẩm</p>
            <p>Nhà thông minh độ ẩm tự động bật/tắt</p>
            <p>Nhà thông minh bật/tắt đèn ngoài</p>
            <p>Nhà thông minh đèn ngoài tự động bật/tắt</p>
            <p>Nhà thông minh bật/tắt vòi nước</p>
            <p>Nhà thông minh bật/tắt đèn</p>
            <p>Nhà thông minh mở/đóng cửa</p>
            <p>Nhà thông minh tắt báo động</p>
        </div>
      </div>
    </div>
  </div>
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#logs">
    Lịch sử thiết bị
</button>
<button type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#voicecmd">
    Danh sách khẩu lệnh
</button>
<div class="container bg-light mt-1 mb-5 pb-5 text-center">
    <p class="output">Giọng nói:...</p>
</div>
<script>
    const recognition = new webkitSpeechRecognition(); // Thay đổi thành SpeechRecognition trên một số trình duyệt

    recognition.lang = 'vi-VN'; // Đổi ngôn ngữ nếu cần

    $(".micro").click(() => {
        recognition.start();
    })

    recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        var speedstring=transcript.toLowerCase();
        $(".output").html('Giọng nói: ' + speedstring);
        switch (speedstring){
            case "nhà thông minh bật máy lạnh":
                $("#btnair").attr('checked',true);
                message = new Paho.MQTT.Message("on");
                message.destinationName = "Shome_ReciveAir";
                client.send(message);
                break;
            case "nhà thông minh tắt máy lạnh":
                $("#btnair").attr('checked',false);
                message = new Paho.MQTT.Message("off");
                message.destinationName = "Shome_ReciveAir";
                client.send(message);
                break;
            case "nhà thông minh máy lạnh tự động bật":
                $("#btnairat").attr('checked',true);
                message = new Paho.MQTT.Message("onat");
                message.destinationName = "Shome_ReciveAir";
                client.send(message);
                break;
            case "nhà thông minh máy lạnh tự động tắt":
                $("#btnairat").attr('checked',false);
                message = new Paho.MQTT.Message("offat");
                message.destinationName = "Shome_ReciveAir";
                client.send(message);
                break;
            case "nhà thông minh bật độ ẩm":
                $("#btnhumi").attr('checked',true);
                message = new Paho.MQTT.Message("on");
                message.destinationName = "Shome_ReciveHumi";
                client.send(message);
                break;
            case "nhà thông minh tắt độ ẩm":
                $("#btnhumi").attr('checked',false);
                message = new Paho.MQTT.Message("off");
                message.destinationName = "Shome_ReciveHumi";
                client.send(message);
                break;
            case "nhà thông minh độ ẩm tự động bật":
                $("#btnhumiat").attr('checked',true);
                message = new Paho.MQTT.Message("onat");
                message.destinationName = "Shome_ReciveHumi";
                client.send(message);
                break;
            case "nhà thông minh độ ẩm tự động tắt":
                $("#btnhumiat").attr('checked',false);
                message = new Paho.MQTT.Message("offat");
                message.destinationName = "Shome_ReciveHumi";
                client.send(message);
                break;
            case "nhà thông minh bật đèn ngoài":
                $("#btnlight").attr('checked',true);
                message = new Paho.MQTT.Message("on");
                message.destinationName = "Shome_ReciveLight";
                client.send(message);
                break;
            case "nhà thông minh tắt đèn ngoài":
                $("#btnlight").attr('checked',false);
                message = new Paho.MQTT.Message("off");
                message.destinationName = "Shome_ReciveLight";
                client.send(message);
                break;
            case "nhà thông minh đèn ngoài tự động bật":
                $("#btnlightat").attr('checked',true);
                message = new Paho.MQTT.Message("onat");
                message.destinationName = "Shome_ReciveLight";
                client.send(message);
                break;
            case "nhà thông minh đèn ngoài tự động tắt":
                $("#btnlightat").attr('checked',false);
                message = new Paho.MQTT.Message("offat");
                message.destinationName = "Shome_ReciveLight";
                client.send(message);
                break;
            case "nhà thông minh bật vòi nước":
                $("#btnwater").attr('checked',true);
                message = new Paho.MQTT.Message("on");
                message.destinationName = "Shome_ReciveSensor";
                client.send(message);
                break;
            case "nhà thông minh tắt vòi nước":
                $("#btnwater").attr('checked',false);
                message = new Paho.MQTT.Message("off");
                message.destinationName = "Shome_ReciveSensor";
                client.send(message);
                break;
            case "nhà thông minh bật đèn":
                $("#btnled").attr('checked',true);
                message = new Paho.MQTT.Message("on");
                message.destinationName = "Shome_ReciveLed";
                client.send(message);
                break;
            case "nhà thông minh tắt đèn":
                $("#btnled").attr('checked',false);
                message = new Paho.MQTT.Message("off");
                message.destinationName = "Shome_ReciveLed";
                client.send(message);
                break;
            case "nhà thông minh mở cửa":
                $("#btndoor").attr('checked',true);
                message = new Paho.MQTT.Message("on");
                message.destinationName = "Shome_ReciveDoor";
                client.send(message);
                break;
            case "nhà thông minh đóng cửa":
                $("#btndoor").attr('checked',false);
                message = new Paho.MQTT.Message("off");
                message.destinationName = "Shome_ReciveDoor";
                client.send(message);
                break;
            case "nhà thông minh tắt báo động":
                $("#btnwarn").trigger('click');
                // message = new Paho.MQTT.Message("none");
                // message.destinationName = "Shome_ReciveSecNone";
                // client.send(message);
                break;
        };
    };


    client = new Paho.MQTT.Client("broker.emqx.io", Number(8083), "0c8e2414-68d7-40db-9272-f7d2c3a9cc73");

    client.onConnectionLost = onConnectionLost;
    client.onMessageArrived = onMessageArrived;

    client.connect({onSuccess:onConnect});

    function onConnect() {
        console.log("onConnect");
        client.subscribe("Shome_DHT");
        client.subscribe("Shome_Motion");
        client.subscribe("Shome_Gas");
        client.subscribe("Shome_Security");
        client.subscribe("Shome_Photoresistor");
        client.subscribe("Shome_Water");
        client.subscribe("Shome_Door");
        client.subscribe("Shome_Light");
        client.subscribe("Shome_Led");
        client.subscribe("Shome_Air");
        client.subscribe("Shome_Humi");
        client.subscribe("Shome_ReciveWeather");
    }

    function onConnectionLost(responseObject) {
        if (responseObject.errorCode !== 0) {
            console.log("onConnectionLost:"+responseObject.errorMessage);
        }
    }

    function onMessageArrived(message) {
        var topic = message.destinationName;
        var datas = message.payloadString;        
        // console.log("Received message from topic:", topic);
        // console.log("Message data:", datas);
        switch (topic) {
            case "Shome_ReciveWeather":
                var temp=datas.split(',');
                $("#infoweather").html(temp[0]);
                $("#wtemp").html(temp[1]+"°C");
                $("#whumi").html(temp[2]+"%");
                $("#wwind").html(temp[3]+"km/h");
                break;
            case "Shome_DHT":
                var temp=datas.split(',');
                $("#temp").html(temp[0]+"°C");
                $("#humi").html(temp[1]+"%");
                break;
            case "Shome_Motion":
                if(datas=="on")
                    $("#storge").html("Có chuyển động!");
                else
                    $("#storge").html("Không có chuyển động!");
                break;
            case "Shome_Gas":
                if(datas=="warn")
                    $("#gas").html("Cảnh báo rò rỉ GAS!");
                else
                    $("#gas").html("Bình thường!");
                break;
            case "Shome_Security":
                if(datas=="warn")
                    $("#sec").html("Cảnh báo!");
                else
                    $("#sec").html("Bình thường!");
                break;
            case "Shome_Light":
                switch (datas){
                    case "on":
                        $("#btnlight").attr('checked',true);
                        break;
                    case "off":
                        $("#btnlight").attr('checked',false);
                        break;
                    case "onat":
                        $("#btnlightat").attr('checked',true);
                        break;
                    case "offat":
                        $("#btnlightat").attr('checked',false);
                        break;
                    default:
                        $("#light").html(datas+" lux");
                        break;
                }
                break;
            case "Shome_Water":
                if(datas=="on")
                    $("#btnwater").attr('checked',true);
                else if(datas=="off")
                    $("#btnwater").attr('checked',false);
                else
                    $("#water").html(datas+" cm");
                break;
            // case "Shome_Door":
            //     console.log("asd for Shome_Door");
            //     break;
            // case "Shome_Led":
            //     console.log("asd for Shome_Led");
            //     break;
            case "Shome_Air":
                switch (datas){
                    case "on":
                        $("#btnair").attr('checked',true);
                        break;
                    case "off":
                        $("#btnair").attr('checked',false);
                        break;
                    case "onat":
                        $("#btnairat").attr('checked',true);
                        break;
                    default:
                        $("#btnairat").attr('checked',false);
                        break;
                }
                break;
            case "Shome_Humi":
                switch (datas){
                    case "on":
                        $("#btnhumi").attr('checked',true);
                        break;
                    case "off":
                        $("#btnhumi").attr('checked',false);
                        break;
                    case "onat":
                        $("#btnhumiat").attr('checked',true);
                        break;
                    default:
                        $("#btnhumiat").attr('checked',false);
                        break;
                }
                break;
            // default:
            //     // Xử lý cho các chủ đề khác nếu cần
            //     break;
        }
    }
    $("#btndoor").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("on");
            message.destinationName = "Shome_ReciveDoor";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("off");
            message.destinationName = "Shome_ReciveDoor";
            client.send(message);
        }
    });
    $("#btnled").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("on");
            message.destinationName = "Shome_ReciveLed";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("off");
            message.destinationName = "Shome_ReciveLed";
            client.send(message);
        }
    });
    $("#btnair").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("on");
            message.destinationName = "Shome_ReciveAir";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("off");
            message.destinationName = "Shome_ReciveAir";
            client.send(message);
        }
    });
    $("#btnairat").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("onat");
            message.destinationName = "Shome_ReciveAir";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("offat");
            message.destinationName = "Shome_ReciveAir";
            client.send(message);
        }
    });
    $("#btnhumi").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("on");
            message.destinationName = "Shome_ReciveHumi";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("off");
            message.destinationName = "Shome_ReciveHumi";
            client.send(message);
        }
    });
    $("#btnhumiat").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("onat");
            message.destinationName = "Shome_ReciveHumi";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("offat");
            message.destinationName = "Shome_ReciveHumi";
            client.send(message);
        }
    });
    $("#btnlight").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("on");
            message.destinationName = "Shome_ReciveLight";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("off");
            message.destinationName = "Shome_ReciveLight";
            client.send(message);
        }
    });
    $("#btnlightat").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("onat");
            message.destinationName = "Shome_ReciveLight";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("offat");
            message.destinationName = "Shome_ReciveLight";
            client.send(message);
        }
    });
    $("#btnwater").change(function(){
        if(this.checked) {
            message = new Paho.MQTT.Message("on");
            message.destinationName = "Shome_ReciveSensor";
            client.send(message);
        }else{
            message = new Paho.MQTT.Message("off");
            message.destinationName = "Shome_ReciveSensor";
            client.send(message);
        }
    });
    $("#btnwarn").click(function(){
        message = new Paho.MQTT.Message("none");
        message.destinationName = "Shome_ReciveSecNone";
        client.send(message);
    });
    
    function logdata(){
        var xmlhttp = new XMLHttpRequest();
        xmlhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            document.getElementById("logdata").innerHTML = this.responseText;
        }
        };
        xmlhttp.open("GET", "./php/logdata.php", true);
        xmlhttp.send();
    }
    const intervalId = setInterval(logdata, 5000);
</script>
</body>
</html>